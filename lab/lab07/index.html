<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta name="description" content="CS 61A: Structure and Interpretation of Computer Programs" />
  <meta name="keywords" content="CS 61A, Computer Science, CS, 61A, Programming, John DeNero, Berkeley, EECS" />
  <meta name="author" content="Hany Farid, John DeNero" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="../../assets/js/hl.js"></script>
  <script>
    // we aren't registering builtins since
    //      (1) they don't render differently in the current CSS from other names
    //      (2) it's a mess to list all of them. You can extract from the site but that takes effort
    // if (1) ceases to be true, (2) might be worth the effort. For now, we're leaving as is
    hljsRegister({
      'keyword': "define if cond and or let begin lambda mu quote delay cons-stream set! quasiquote unquote unquote-splicing define-macro"
    });
    hljs.initHighlightingOnLoad();
  </script>
  <script src="../../assets/js/dark-mode.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,500|Work+Sans:400,700">
  <link rel="stylesheet" href="../../assets/css/style.css">
  <link rel="stylesheet" href="../../assets/css/mono-blue.css">
  <link rel="icon" href="../../assets/images/favicon.ico">



  <title>
    Lab 7: Iterators, Generators, Object-Oriented Programming | CS 61A Fall 2020
  </title>
</head>

<body id="index" class="home">
  <nav class="navbar navbar-default navbar-static-top">
    <div class="container noselect">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
          data-target="#navbar-collapse-section">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../">
          <img style="max-width:60px; margin-top: -20px;" class="logo" src="../../assets/images/logo.png" />
        </a>
      </div>

      <div class="collapse navbar-collapse" id="navbar-collapse-section">
        <ul class="nav navbar-nav navbar-right">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              Staff
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li><a href="../../instructor.html">Instructors</a></li>
              <li><a href="../../TAs.html">TAs</a></li>
              <li><a href="../../tutors.html">Tutors</a></li>
            </ul>
          </li>
          <li><a href="../../resources.html">Resources</a></li>
          <li><a href="../../articles/about.html">Syllabus</a></li>
          <li><a href="https://code.cs61a.org">Code</a></li>
          <li><a href="http://tutor.cs61a.org" target="_blank">Tutor</a></li>
          <li>
            <a style="color:white; font-size: 15px;vertical-align: middle" href="https://github.com/ChillyHigh/CS61A-CN"
              title="前往仓库" target="_blank">
              <img height="21px" src="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/github.svg" alt="GitHub"
                style="filter: invert(1) brightness(1000%);">
              <span style="vertical-align: middle;padding-left: 0.5rem;"> CS61A-CN</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <main id="content" class="container">

    <div class='row'>
      <div class='col-md-9'>
        <header>
          <h1>

            实验7: 迭代器、生成器、面向对象编程

            <br>
            <small>
              Lab 7: Iterators, Generators, Object-Oriented Programming
            </small>
            <br>

            <ul class="inline-block list-inline">
              <li><a href="lab07.zip" class="label label-outline">lab07.zip</a></li>
            </ul>


          </h1>
        </header>


        <p><i>Due by 11:59pm on Tuesday, October 13.</i></p>




        <h3><a href="EN.html">查看英文原文</a></h3>
        <h2 id='starter-files'>初始文件</h2>

        <p>下载 <a href="lab07.zip">lab07.zip</a>。
          在压缩包中，你可以找到本实验问题的初始文件，以及一份 <a href="ok">Ok</a> 自动评分器。</p>







        <h1 id="topics">主要内容</h1>

        <p>如果你需要复习本实验的材料，请参考本节。你可以直接跳到<a href="#required-questions">问题部分</a>，遇到困难再回到这里。</p>


        <button id='toggle-1' class='btn btn-outline btn-lg alwaystoggle toggle'>
          Iterators<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-1">

          <h2 id="iterators">Iterators</h2>

          <!-- In lecture, we studied several Python object interfaces, or _protocols_. In this
lab, we will study a new protocol, the _iterator protocol_. Implementing this
protocol allows us to use our objects in for loops! Remember the <code>for</code> loop?
(We really hope so!) -->

          <p>An iterable is any object that can be iterated through, or gone through one
            element at a time. One construct that we've used to iterate through an
            iterable is a for loop:</p>

          <pre><code>for elem in iterable:
    # do something</code></pre>

          <p><code>for</code> loops work on any object that is <em>iterable</em>. We previously described it
            as working with any sequence -- all sequences are iterable, but there are other
            objects that are also iterable! We define an <strong>iterable</strong> as an object on which
            calling the built-in function <code>iter</code> function returns an <em>iterator</em>. An
            iterator is another type of object that allows us to iterate through an
            iterable by keeping track of which element is next in the sequence.</p>

          <p>To illustrate this, consider the following block of code, which does the exact
            same thing as a the for statement above:</p>

          <pre><code>iterator = iter(iterable)
try:
    while True:
        elem = next(iterator)
        # do something
except StopIteration:
    pass</code></pre>

          <p>Here's a breakdown of what's happening:</p>

          <ul>
            <li>First, the built-in <code>iter</code> function is called on the iterable to create a
              corresponding <em>iterator</em>.</li>
            <li>To get the next element in the sequence, the built-in <code>next</code> function is
              called on this iterator.</li>
            <li>When <code>next</code> is called but there are no elements left in the iterator, a
              <code>StopIteration</code> error is raised. In the for loop construct, this exception is
              caught and execution can continue.
            </li>
          </ul>

          <p>Calling <code>iter</code> on an iterable multiple times returns a new iterator each time
            with distinct states (otherwise, you'd never be able to iterate through a
            iterable more than once). You can also call <code>iter</code> on the iterator itself, which
            will just return the same iterator without changing its state. However, note
            that you cannot call <code>next</code> directly on an iterable.</p>

          <p>Let's see the <code>iter</code> and <code>next</code> functions in action with an iterable we're
            already familiar with -- a list.</p>

          <pre><code>&gt;&gt;&gt; lst = [1, 2, 3, 4]
&gt;&gt;&gt; next(lst)             # Calling next on an iterable
TypeError: &#x27;list&#x27; object is not an iterator
&gt;&gt;&gt; list_iter = iter(lst) # Creates an iterator for the list
&gt;&gt;&gt; list_iter
&lt;list_iterator object ...&gt;
&gt;&gt;&gt; next(list_iter)       # Calling next on an iterator
1
&gt;&gt;&gt; next(list_iter)       # Calling next on the same iterator
2
&gt;&gt;&gt; next(iter(list_iter)) # Calling iter on an iterator returns itself
3
&gt;&gt;&gt; list_iter2 = iter(lst)
&gt;&gt;&gt; next(list_iter2)      # Second iterator has new state
1
&gt;&gt;&gt; next(list_iter)       # First iterator is unaffected by second iterator
4
&gt;&gt;&gt; next(list_iter)       # No elements left!
StopIteration
&gt;&gt;&gt; lst                   # Original iterable is unaffected
[1, 2, 3, 4]</code></pre>

          <p>Since you can call <code>iter</code> on iterators, this tells us that that they are also
            iterables! Note that while all iterators are iterables, the converse is not
            true - that is, not all iterables are iterators. You can use iterators wherever
            you can use iterables, but note that since iterators keep their state, they're
            only good to iterate through an iterable once:</p>

          <pre><code>&gt;&gt;&gt; list_iter = iter([4, 3, 2, 1])
&gt;&gt;&gt; for e in list_iter:
...     print(e)
4
3
2
1
&gt;&gt;&gt; for e in list_iter:
...     print(e)</code></pre>

          <blockquote>
            <p><strong>Analogy</strong>: An iterable is like a book (one can flip through the
              pages) and an iterator for a book would be a bookmark (saves the position and
              can locate the next page). Calling <code>iter</code> on a book gives you a new bookmark
              independent of other bookmarks, but calling <code>iter</code> on a bookmark gives you the
              bookmark itself, without changing its position at all. Calling <code>next</code> on the
              bookmark moves it to the next page, but does not change the pages in the book.
              Calling <code>next</code> on the book wouldn't make sense semantically. We can also have
              multiple bookmarks, all independent of each other.</p>
          </blockquote>


          <h3 id="iterable-uses">Iterable Uses</h3>


          <p>We know that lists are one type of built-in iterable objects. You may have also
            encountered the <code>range(start, end)</code> function, which creates an iterable of
            ascending integers from start (inclusive) to end (exclusive).</p>

          <pre><code>&gt;&gt;&gt; for x in range(2, 6):
...     print(x)
...
2
3
4
5</code></pre>

          <p>Ranges are useful for many things, including performing some operations for a
            particular number of iterations or iterating through the indices of a list.</p>

          <p>There are also some built-in functions that take in iterables and return useful
            results:</p>

          <ul>
            <li><code>map(f, iterable)</code> - Creates iterator over <code>f(x)</code> for each <code>x</code> in
              <code>iterable</code>
            </li>
            <li><code>filter(f, iterable)</code> - Creates iterator over <code>x</code> for each <code>x</code> in
              <code>iterable</code>
              if <code>f(x)</code>
            </li>
            <li><code>zip(iter1, iter2)</code> - Creates iterator over co-indexed pairs (x, y) from both
              input iterables</li>
            <li><code>reversed(iterable)</code> - Creates iterator over all the elements in the input
              iterable in reverse order</li>
            <li><code>list(iterable)</code> - Creates a list containing all the elements in the input iterable</li>
            <li><code>tuple(iterable)</code> - Creates a tuple containing all the elements in the input iterable</li>
            <li><code>sorted(iterable)</code> - Creates a sorted list containing all the elements in the
              input iterable</li>
          </ul>

          <!--
How does <code>iter</code> work? It just calls the <code>__iter__</code> magic method on its argument,
so <code>iter(something_iterable)</code> is equivalent to <code>something_iterable.__iter__()</code>.
So, any object is iterable if it implements this magic method, and this method
must return an iterator.

How does <code>next</code> work? It just calls the <code>__next__</code> magic method on its argument,
so <code>next(the_iterator)</code> is equivalent to <code>the_iterator.__next__()</code>. So, to
implement the iterator protocol, we must implement this method. This method
eithers returns the next element in our iteration (so it's usually non-pure!),
or raises <code>StopIteration</code> when there are no elements left.-->

          <!--
Here is a table summarizing the required methods on iterables and iterators.
Python also has more
<a href="https://docs.python.org/3/library/stdtypes.html#typeiter">documentation</a> about
<a href="https://docs.python.org/3/glossary.html#term-iterable">iterable</a> and
<a href="https://docs.python.org/3/glossary.html#term-iterator">iterator</a> types.

<div class = "table-responsive">
  <table class='table table-bordered'>
    <tr>
      <th>Iterable</th>
      <th>Iterator</th>
    </tr>
    <tr>
      <td><code>__iter__</code>: returns an iterator</td>
      <td><code>__iter__</code>: returns an iterator, which is generally itself</td>
    <tr>
      <td><code>__next__</code>: (optional) need not be defined </td>
      <td><code>__next__</code>: returns the next element, or raises
      <code>StopIteration</code> if no more values left to produce</td>
    </tr>
  </table>
</div>

-->

          <!--
Normally, when implementing a protocol, we create objects that are *both*
iterable and an iterator, so it will have both the <code>__iter__</code> and <code>__next__</code>
methods implemented. This is more convenient than creating two separate objects,
so it is good to do this whenever possible. Here is an example of a class
definition for an object that implements both the iterable and iterator
interfaces:

<pre><code>class Skipper:
    def __init__(self, seq):
        self.seq = seq
        self.step = 1
        self.current = 0

    def __next__(self):
        if self.current &gt;= len(self.seq):
            raise StopIteration
        val = self.seq[self.current]
        self.current += self.step
        self.step += 1
        return val

    def __iter__(self):
        return self</code></pre>

Let's go ahead and try out our new toy.

<pre><code>&gt;&gt;&gt; for num in Skipper([3, 4, 5, 6, 7, 8, 9, 10]):
...     print(num)
3
4
6
9</code></pre>

That is, we skip through the elements of some sequence in ever-larger steps.
-->

          <!--
We can also use <code>Skipper</code> to create a new kind of iterable list:

<pre><code>class SkippingList(list):

    def __iter__(self):
        return Skipper(self)</code></pre>

and now we can write:

<pre><code>&gt;&gt;&gt; aList = SkippingList([3, 4, 5, 6, 7, 8, 9, 10])
&gt;&gt;&gt; for num in aList:
...     print(num)
3
4
6
9</code></pre>

-->
        </div>


        <button id='toggle-2' class='btn btn-outline btn-lg alwaystoggle toggle'>
          Generators<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-2">

          <h2 id="generators">Generators</h2>


          <p>We can create our own custom iterators by writing a <em>generator function</em>, which
            returns a special type of iterator called a <strong>generator</strong>. Generator functions
            have <code>yield</code> statements within the body of the function instead of <code>return</code>
            statements. Calling a generator function will return a generator object and
            will <em>not</em> execute the body of the function.</p>

          <p>For example, let's consider the following generator function:</p>

          <pre><code>def countdown(n):
    print(&quot;Beginning countdown!&quot;)
    while n &gt;= 0:
        yield n
        n &#x2d;= 1
    print(&quot;Blastoff!&quot;)</code></pre>

          <p>Calling <code>countdown(k)</code> will return a generator object that counts down from <code>k</code>
            to 0. Since generators are iterators, we can call <code>iter</code> on the resulting
            object, which will simply return the same object. Note that the body is not
            executed at this point; nothing is printed and no numbers are output.</p>

          <pre><code>&gt;&gt;&gt; c = countdown(5)
&gt;&gt;&gt; c
&lt;generator object countdown ...&gt;
&gt;&gt;&gt; c is iter(c)
True</code></pre>

          <p>So how is the counting done? Again, since generators are iterators, we call
            <code>next</code> on them to get the next element! The first time <code>next</code> is called,
            execution begins at the first line of the function body and continues until the
            <code>yield</code> statement is reached. The result of evaluating the expression in the
            <code>yield</code> statement is returned. The following interactive session continues
            from the one above.
          </p>

          <pre><code>&gt;&gt;&gt; next(c)
Beginning countdown!
5</code></pre>

          <p>Unlike functions we've seen before in this course, generator functions can
            remember their state. On any consecutive calls to <code>next</code>, execution picks up
            from the line after the <code>yield</code> statement that was previously executed. Like
            the first call to <code>next</code>, execution will continue until the next <code>yield</code>
            statement is reached. Note that because of this, <code>Beginning countdown!</code> doesn't
            get printed again.</p>

          <pre><code>&gt;&gt;&gt; next(c)
4
&gt;&gt;&gt; next(c)
3</code></pre>

          <p>The next 3 calls to <code>next</code> will continue to yield consecutive descending
            integers until 0. On the following call, a <code>StopIteration</code> error will be
            raised because there are no more values to yield (i.e. the end of the function
            body was reached before hitting a <code>yield</code> statement).</p>

          <pre><code>&gt;&gt;&gt; next(c)
2
&gt;&gt;&gt; next(c)
1
&gt;&gt;&gt; next(c)
0
&gt;&gt;&gt; next(c)
Blastoff!
StopIteration</code></pre>

          <p>Separate calls to <code>countdown</code> will create distinct generator objects with their
            own state. Usually, generators shouldn't restart. If you'd like to reset the
            sequence, create another generator object by calling the generator function
            again.</p>

          <pre><code>&gt;&gt;&gt; c1, c2 = countdown(5), countdown(5)
&gt;&gt;&gt; c1 is c2
False
&gt;&gt;&gt; next(c1)
5
&gt;&gt;&gt; next(c2)
5</code></pre>

          <p>Here is a summary of the above:</p>

          <ul>
            <li>A <em>generator function</em> has a <code>yield</code> statement and returns a <em>generator
                object</em>.</li>
            <li>Calling the <code>iter</code> function on a generator object returns the same object
              without modifying its current state.</li>
            <li>The body of a generator function is not evaluated until <code>next</code> is called on
              a resulting generator object. Calling the <code>next</code> function on a generator
              object computes and returns the next object in its sequence. If the sequence
              is exhausted, <code>StopIteration</code> is raised.</li>
            <li>
              <p>A generator "remembers" its state for the next <code>next</code> call. Therefore,</p>

              <ul>
                <li>
                  <p>the first <code>next</code> call works like this:</p>

                  <ol>
                    <li>Enter the function and run until the line with <code>yield</code>.</li>
                    <li>Return the value in the <code>yield</code> statement, but remember the state of the
                      function for future <code>next</code> calls.</li>
                  </ol>
                </li>
                <li>
                  <p>And subsequent <code>next</code> calls work like this:</p>

                  <ol>
                    <li>Re-enter the function, start at <strong>the line after the <code>yield</code> statement that
                        was previously executed</strong>, and run until the next <code>yield</code> statement.</li>
                    <li>Return the value in the <code>yield</code> statement, but remember the state of the
                      function for future <code>next</code> calls.</li>
                  </ol>
                </li>
              </ul>
            </li>
            <li>Calling a generator function returns a brand new generator object (like
              calling <code>iter</code> on an iterable object).</li>
            <li>A generator should not restart unless it's defined that way. To start over
              from the first element in a generator, just call the generator function again
              to create a new generator.</li>
          </ul>

          <p>Another useful tool for generators is the <code>yield from</code> statement (introduced in
            Python 3.3). <code>yield from</code> will yield all values from an iterator or iterable.</p>

          <pre><code>&gt;&gt;&gt; def gen_list(lst):
...     yield from lst
...
&gt;&gt;&gt; g = gen_list([1, 2, 3, 4])
&gt;&gt;&gt; next(g)
1
&gt;&gt;&gt; next(g)
2
&gt;&gt;&gt; next(g)
3
&gt;&gt;&gt; next(g)
4
&gt;&gt;&gt; next(g)
StopIteration</code></pre>

        </div>


        <button id='toggle-3' class='btn btn-outline btn-lg alwaystoggle toggle'>
          Object-Oriented Programming<noscript> (enable JavaScript)</noscript>
        </button>
        <div class="solution toggle-3">

          <h2 id="object-oriented-programming">Object-Oriented Programming</h2>


          <p><strong>Object-oriented programming</strong> (OOP) is a style of programming that
            allows you to think of code in terms of "objects." Here's an example of
            a <code>Car</code> class:</p>

          <pre><code>class Car(object):
    num_wheels = 4

    def __init__(self, color):
        self.wheels = Car.num_wheels
        self.color = color

    def drive(self):
        if self.wheels &lt;= Car.num_wheels:
            return self.color + &#x27; car cannot drive!&#x27;
        return self.color + &#x27; car goes vroom!&#x27;

    def pop_tire(self):
        if self.wheels &gt; 0:
            self.wheels &#x2d;= 1</code></pre>

          <p>Here's some terminology:</p>

          <ul>
            <li><strong>class</strong>: a blueprint for how to build a certain type of object.
              The <code>Car</code> class (shown above) describes the behavior and data that
              all <code>Car</code> objects have.</li>
            <li>
              <p><strong>instance</strong>: a particular occurrence of a class. In Python, we
                create instances of a class like this:</p>

              <pre><code>&gt;&gt;&gt; my_car = Car(&#x27;red&#x27;)</code></pre>

              <p><code>my_car</code> is an instance of the <code>Car</code> class.</p>
            </li>
            <li>
              <p><strong>attribute</strong> or <strong>field</strong>: a variable that belongs to the class.
                Think of an attribute as a quality of the object: cars have <em>wheels</em>
                and <em>color</em>, so we have given our <code>Car</code> class <code>self.wheels</code> and
                <code>self.color</code> attributes. We can access attributes using <strong>dot
                  notation</strong>:
              </p>

              <pre><code>&gt;&gt;&gt; my_car.color
&#x27;red&#x27;
&gt;&gt;&gt; my_car.wheels
4</code></pre>
            </li>
            <li>
              <p><strong>method</strong>: Methods are just like normal functions, except that they
                are tied to an instance or a class. Think of a method as a "verb" of
                the class: cars can <em>drive</em> and also <em>pop their tires</em>, so we have
                given our <code>Car</code> class the methods <code>drive</code> and <code>pop_tire</code>. We call
                methods using <strong>dot notation</strong>:</p>

              <pre><code>&gt;&gt;&gt; my_car = Car(&#x27;red&#x27;)
&gt;&gt;&gt; my_car.drive()
&#x27;red car goes vroom!&#x27;</code></pre>
            </li>
            <li>
              <p><strong>constructor</strong>: As with data abstraction, constructors describe how
                to build an instance of the class. Most classes have a constructor.
                In Python, the constructor of the class defined as <code>__init__</code>. For
                example, here is the <code>Car</code> class's constructor:</p>

              <pre><code>def __init__(self, color):
    self.wheels = Car.num_wheels
    self.color = color</code></pre>

              <p>The constructor takes in one argument, <code>color</code>. As you can see, the
                constructor also creates the <code>self.wheels</code> and <code>self.color</code> attributes.</p>
            </li>
            <li>
              <p><code>self</code>: in Python, <code>self</code> is the first parameter for many methods
                (in this class, we will only use methods whose first parameter is
                <code>self</code>). When a method is called, <code>self</code> is bound to an instance of
                the class. For example:
              </p>

              <pre><code>&gt;&gt;&gt; my_car = Car(&#x27;red&#x27;)
&gt;&gt;&gt; car.drive()</code></pre>

              <p>Notice that the <code>drive</code> method takes in <code>self</code> as an argument, but it
                looks like we didn't pass one in! This is because the dot notation
                <em>implicitly</em> passes in <code>car</code> as <code>self</code> for us.
        </div>
        <br></p>
        </li>
        </ul>


        <h1 id="required-questions">必答题</h1>



        <h2 id="iterators-and-generators">迭代器与生成器</h2>

        <p>生成器允许我们表示无限序列，例如下面函数中显示的自然数序列 (1, 2, ...)！</p>

        <pre><code>def naturals():
    &quot;&quot;&quot;A generator function that yields the infinite sequence of natural
    numbers, starting at 1.

    &gt;&gt;&gt; m = naturals()
    &gt;&gt;&gt; type(m)
    &lt;class &#x27;generator&#x27;&gt;
    &gt;&gt;&gt; [next(m) for _ in range(10)]
    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    &quot;&quot;&quot;
    i = 1
    while True:
        yield i
        i += 1</code></pre>

        <h3 class="question" id="q1">Q1: 缩放序列</h3>

        <p>实现生成器函数 <code>scale(it, multiplier)</code>，它会产生可迭代对象 <code>it</code> 中的元素，
          并将每个元素按 <code>multiplier</code> 进行缩放。
          作为额外挑战，尝试使用 <code>yield from</code> 语句来实现这个函数！</p>

        <solution>

          <pre><code>def scale(it, multiplier):
    &quot;&quot;&quot;Yield elements of the iterable it scaled by a number multiplier.

    &gt;&gt;&gt; m = scale([1, 5, 2], 5)
    &gt;&gt;&gt; type(m)
    &lt;class &#x27;generator&#x27;&gt;
    &gt;&gt;&gt; list(m)
    [5, 25, 10]

    &gt;&gt;&gt; m = scale(naturals(), 2)
    &gt;&gt;&gt; [next(m) for _ in range(5)]
    [2, 4, 6, 8, 10]
    &quot;&quot;&quot;
    "*** YOUR CODE HERE ***"
</code></pre>

        </solution>

        <p>使用 Ok 来测试你的代码：</p>
        <pre><code class="nohighlight">python3 ok -q scale --local</code></pre>

        <h3 class="question" id="q2">Q2: 冰雹序列</h3>

        <p>编写一个生成器，它输出作业1 中的冰雹序列。</p>

        <p>以下是冰雹序列的定义：</p>

        <ol>
          <li>选择一个正整数 <code>n</code> 作为起始值。</li>
          <li>如果 <code>n</code> 是偶数，则将其除以 2。</li>
          <li>如果 <code>n</code> 是奇数，则将其乘以 3 并加 1。</li>
          <li>重复此过程，直到 <code>n</code> 变为 1。</li>
        </ol>

        <p><strong>注意：</strong> 强烈建议（但不强制要求）使用递归来编写解决方案，以获得额外的练习。
          由于 <code>hailstone</code> 返回一个生成器，你可以使用 <code>yield from</code> 调用 <code>hailstone</code>！
        </p>


        <solution>

          <pre><code>def hailstone(n):
    &quot;&quot;&quot;
    &gt;&gt;&gt; for num in hailstone(10):
    ...     print(num)
    ...
    10
    5
    16
    8
    4
    2
    1
    &quot;&quot;&quot;
    "*** YOUR CODE HERE ***"
</code></pre>

        </solution>

        <p>使用 Ok 来测试你的代码：</p>
        <pre><code class="nohighlight">python3 ok -q hailstone --local</code></pre>

        <h2 id="wwpd-objects">WWPD: 对象</h2>

        <h3 class="question" id="q3">Q3: 汽车类 (Car Class)</h3>

        <p><strong>注意：</strong> 这些问题涉及继承。要了解继承的概述，请参考课本中的
          <a href="https://composingprograms.netlify.app/2/5#_2-5-5-%E7%BB%A7%E6%89%BF">继承部分</a>。
        </p>

        <p>下面是 <code>Car</code> 类的定义，我们将在后续 WWPD（Python 会输出什么？）问题中使用它。
          <strong>注意：</strong> 该定义也可以在 <code>car.py</code> 文件中找到。
        </p>


        <pre><code>class Car(object):
    num_wheels = 4
    gas = 30
    headlights = 2
    size = &#x27;Tiny&#x27;

    def __init__(self, make, model):
        self.make = make
        self.model = model
        self.color = &#x27;No color yet. You need to paint me.&#x27;
        self.wheels = Car.num_wheels
        self.gas = Car.gas

    def paint(self, color):
        self.color = color
        return self.make + &#x27; &#x27; + self.model + &#x27; is now &#x27; + color

    def drive(self):
        if self.wheels &lt; Car.num_wheels or self.gas &lt;= 0:
            return &#x27;Cannot drive!&#x27;
        self.gas &#x2d;= 10
        return self.make + &#x27; &#x27; + self.model + &#x27; goes vroom!&#x27;

    def pop_tire(self):
        if self.wheels &gt; 0:
            self.wheels &#x2d;= 1

    def fill_gas(self):
        self.gas += 20
        return &#x27;Gas level: &#x27; + str(self.gas)</code></pre>

        <blockquote>
          <p>使用 Ok 测试你对以下 "Python 会输出什么"（WWPD）问题的理解。</p>

          <pre><code>python3 ok -q wwpd-car -u --local</code></pre>

          <p>如果产生错误，请输入 <code>Error</code>。如果没有输出，请输入 <code>Nothing</code>。</p>
        </blockquote>

        <pre><code>&gt;&gt;&gt; deneros_car = Car(&#x27;Tesla&#x27;, &#x27;Model S&#x27;)
&gt;&gt;&gt; deneros_car.model
<div class="alt prompt-3">______</div><div class="solution prompt-3">&#x27;&#x4d;&#x6f;&#x64;&#x65;&#x6c;&#x20;&#x53;&#x27;</div>
&gt;&gt;&gt; deneros_car.gas = 10
&gt;&gt;&gt; deneros_car.drive()
<div class="alt prompt-3">______</div><div class="solution prompt-3">&#x27;&#x54;&#x65;&#x73;&#x6c;&#x61;&#x20;&#x4d;&#x6f;&#x64;&#x65;&#x6c;&#x20;&#x53;&#x20;&#x67;&#x6f;&#x65;&#x73;&#x20;&#x76;&#x72;&#x6f;&#x6f;&#x6d;&#x21;&#x27;</div>
&gt;&gt;&gt; deneros_car.drive()
<div class="alt prompt-3">______</div><div class="solution prompt-3">&#x27;&#x43;&#x61;&#x6e;&#x6e;&#x6f;&#x74;&#x20;&#x64;&#x72;&#x69;&#x76;&#x65;&#x21;&#x27;</div>
&gt;&gt;&gt; deneros_car.fill_gas()
<div class="alt prompt-3">______</div><div class="solution prompt-3">&#x27;&#x47;&#x61;&#x73;&#x20;&#x6c;&#x65;&#x76;&#x65;&#x6c;&#x3a;&#x20;&#x32;&#x30;&#x27;</div>
&gt;&gt;&gt; deneros_car.gas
<div class="alt prompt-3">______</div><div class="solution prompt-3">&#x32;&#x30;</div>
&gt;&gt;&gt; Car.gas
<div class="alt prompt-3">______</div><div class="solution prompt-3">&#x33;&#x30;</div></code></pre>
        <button id='prompt-3' class='btn btn-outline btn-lg solutiontoggle prompt'>
          Toggle Solution<noscript> (enable JavaScript)</noscript>
        </button>

        <pre><code>&gt;&gt;&gt; deneros_car = Car(&#x27;Tesla&#x27;, &#x27;Model S&#x27;)
&gt;&gt;&gt; deneros_car.wheels = 2
&gt;&gt;&gt; deneros_car.wheels
<div class="alt prompt-5">______</div><div class="solution prompt-5">&#x32;</div>
&gt;&gt;&gt; Car.num_wheels
<div class="alt prompt-5">______</div><div class="solution prompt-5">&#x34;</div>
&gt;&gt;&gt; deneros_car.drive()
<div class="alt prompt-5">______</div><div class="solution prompt-5">&#x27;&#x43;&#x61;&#x6e;&#x6e;&#x6f;&#x74;&#x20;&#x64;&#x72;&#x69;&#x76;&#x65;&#x21;&#x27;</div>
&gt;&gt;&gt; Car.drive()
<div class="alt prompt-5">______</div><div class="solution prompt-5">&#x45;&#x72;&#x72;&#x6f;&#x72;&#x20;&#x28;&#x54;&#x79;&#x70;&#x65;&#x45;&#x72;&#x72;&#x6f;&#x72;&#x29;</div>
&gt;&gt;&gt; Car.drive(deneros_car)
<div class="alt prompt-5">______</div><div class="solution prompt-5">&#x27;&#x43;&#x61;&#x6e;&#x6e;&#x6f;&#x74;&#x20;&#x64;&#x72;&#x69;&#x76;&#x65;&#x21;&#x27;</div></code></pre>

        <p>对于以下问题，我们参考 <code>MonsterTruck</code> 类。
          <strong>注意</strong>：<code>MonsterTruck</code> 类也可以在 <code>car.py</code> 中找到。
        </p>

        <pre><code> class MonsterTruck(Car):
     size = &#x27;Monster&#x27;

     def rev(self):
         print(&#x27;Vroom! This Monster Truck is huge!&#x27;)

     def drive(self):
         self.rev()
         return Car.drive(self)</code></pre>

        <pre><code>&gt;&gt;&gt; deneros_car = MonsterTruck(&#x27;Monster&#x27;, &#x27;Batmobile&#x27;)
&gt;&gt;&gt; deneros_car.drive()
<div class="alt prompt-6">______</div><div class="solution prompt-6">&#x56;&#x72;&#x6f;&#x6f;&#x6d;&#x21;&#x20;&#x54;&#x68;&#x69;&#x73;&#x20;&#x4d;&#x6f;&#x6e;&#x73;&#x74;&#x65;&#x72;&#x20;&#x54;&#x72;&#x75;&#x63;&#x6b;&#x20;&#x69;&#x73;&#x20;&#x68;&#x75;&#x67;&#x65;&#x21;&#xa;&#x27;&#x4d;&#x6f;&#x6e;&#x73;&#x74;&#x65;&#x72;&#x20;&#x42;&#x61;&#x74;&#x6d;&#x6f;&#x62;&#x69;&#x6c;&#x65;&#x20;&#x67;&#x6f;&#x65;&#x73;&#x20;&#x76;&#x72;&#x6f;&#x6f;&#x6d;&#x21;&#x27;</div>
&gt;&gt;&gt; Car.drive(deneros_car)
<div class="alt prompt-6">______</div><div class="solution prompt-6">&#x27;&#x4d;&#x6f;&#x6e;&#x73;&#x74;&#x65;&#x72;&#x20;&#x42;&#x61;&#x74;&#x6d;&#x6f;&#x62;&#x69;&#x6c;&#x65;&#x20;&#x67;&#x6f;&#x65;&#x73;&#x20;&#x76;&#x72;&#x6f;&#x6f;&#x6d;&#x21;&#x27;</div>
&gt;&gt;&gt; MonsterTruck.drive(deneros_car)
<div class="alt prompt-6">______</div><div class="solution prompt-6">&#x56;&#x72;&#x6f;&#x6f;&#x6d;&#x21;&#x20;&#x54;&#x68;&#x69;&#x73;&#x20;&#x4d;&#x6f;&#x6e;&#x73;&#x74;&#x65;&#x72;&#x20;&#x54;&#x72;&#x75;&#x63;&#x6b;&#x20;&#x69;&#x73;&#x20;&#x68;&#x75;&#x67;&#x65;&#x21;&#xa;&#x27;&#x4d;&#x6f;&#x6e;&#x73;&#x74;&#x65;&#x72;&#x20;&#x42;&#x61;&#x74;&#x6d;&#x6f;&#x62;&#x69;&#x6c;&#x65;&#x20;&#x67;&#x6f;&#x65;&#x73;&#x20;&#x76;&#x72;&#x6f;&#x6f;&#x6d;&#x21;&#x27;</div>
&gt;&gt;&gt; Car.rev(deneros_car)
<div class="alt prompt-6">______</div><div class="solution prompt-6">&#x45;&#x72;&#x72;&#x6f;&#x72;&#x20;&#x28;&#x41;&#x74;&#x74;&#x72;&#x69;&#x62;&#x75;&#x74;&#x65;&#x45;&#x72;&#x72;&#x6f;&#x72;&#x29;</div></code></pre>



        <h2 id="magic-the-lambda-ing">Magic: The Lambda-ing</h2>

        <p>在本实验的下一部分，我们将实现一款卡牌游戏！</p>

        <p>你可以通过以下命令启动游戏：</p>

        <pre><code>python3 cardgame.py</code></pre>

        <p><strong>这个游戏目前还不能运行</strong>。如果我们现在运行它，代码会报错，因为我们还没有实现任何内容。
          当游戏正常运行后，你可以使用 <code>Ctrl-C</code> 或 <code>Ctrl-D</code> 退出游戏并返回命令行。</p>

        <p>这个游戏使用了多个不同的文件：</p>

        <ul>
          <li>本实验所有问题的代码都可以在 <code>classes.py</code> 中找到。</li>
          <li>游戏的一些工具代码在 <code>cardgame.py</code> 中，但你不需要打开或阅读这个文件。
            这个文件实际上不会直接修改任何实例，而是调用不同类的方法，严格保持抽象屏障。</li>
          <li>如果你想在以后修改游戏，添加自定义卡牌和卡组，可以查看 <code>cards.py</code>。
            这个文件包含了所有标准卡牌和默认卡组；你可以在这里添加更多卡牌，或者更改你和对手使用的卡组。
            这些卡牌在设计时没有考虑平衡性，因此你可以随意调整属性，添加或移除卡牌。</li>
        </ul>

        <p><strong>游戏规则</strong> 这个游戏相对复杂，但远没有它的同名游戏那么复杂。游戏流程如下：</p>

        <p>游戏有两名玩家。每位玩家都有一手牌和一个卡组，每轮开始时，每位玩家从卡组中抽一张牌。
          如果玩家在尝试抽牌时卡组已空，则该玩家会自动输掉游戏。
          卡牌具有名称、攻击力和防御力。每轮，每位玩家从手牌中选择一张卡牌进行对战。
          具有更高<em>战斗力</em>的卡牌赢得该轮对战。
          每张已出战卡牌的战斗力计算方式如下：</p>

        <pre><code>(player card&#x27;s attack) &#x2d; (opponent card&#x27;s defense) / 2</code></pre>

        <p>例如，假设 Player 1 出了一张攻击力 2000 / 防御力 1000 的卡牌，而 Player 2 出了一张攻击力 1500 / 防御力 3000 的卡牌。
          他们的卡牌战斗力计算如下：</p>

        <pre><code>P1: 2000 &#x2d; 3000/2 = 2000 &#x2d; 1500 = 500
P2: 1500 &#x2d; 1000/2 = 1500 &#x2d; 500 = 1000</code></pre>

        <p>因此，Player 2 赢得这一轮对战。</p>

        <p>第一个赢得 8 轮的 Player 将赢得整场比赛！</p>

        <p>不过，在可选问题部分，我们还可以添加一些特殊效果，使游戏更加有趣。卡牌分为 Tutor、TA 和 Professor 类型，
          每种类型的卡牌在出战时都会触发不同的 <em>效果</em>，并且这些效果会在当轮战斗力计算之前生效：</p>

        <ul>
          <li><strong>Tutor</strong> 使对手弃掉手牌中的前三张卡，并重新抽取三张。</li>
          <li><strong>TA</strong> 交换对手卡牌的攻击力和防御力。</li>
          <li><strong>Professor</strong> 将对手卡牌的攻击力和防御力加到对手卡组的所有卡牌上，
            然后移除对手卡组中所有攻击力 <em>或</em> 防御力与该卡牌相同的卡。</li>
        </ul>

        <p>规则较多，如果需要回顾规则，请随时返回此处查看。现在让我们开始制作这款游戏吧！</p>

        <h3 class="question" id="q4">Q4: 创建卡牌</h3>

        <p>要玩卡牌游戏，我们首先需要制作卡牌！让我们先实现 <code>Card</code> 类的基本功能。</p>

        <p>首先，在 <code>classes.py</code> 中实现 <code>Card</code> 类的构造方法，该方法接受三个参数：</p>

        <ul>
          <li>卡牌的 <code>name</code>（名称），字符串类型</li>
          <li>卡牌的 <code>attack</code>（攻击力），整数类型</li>
          <li>卡牌的 <code>defense</code>（防御力），整数类型</li>
        </ul>

        <p>每个 <code>Card</code> 实例都应该使用实例属性 <code>name</code>、<code>attack</code> 和 <code>defense</code> 来存储这些值。</p>

        <p>你还需要实现 <code>Card</code> 类中的 <code>power</code> 方法，该方法接收另一张卡牌作为输入，
          并计算当前卡牌的战斗力。如果需要回顾战斗力计算方式，请查看规则部分。</p>

        <solution>

          <pre><code>class Card:
    cardtype = &#x27;Staff&#x27;

    def __init__(self, name, attack, defense):
        &quot;&quot;&quot;
        Create a Card object with a name, attack,
        and defense.
        &gt;&gt;&gt; staff_member = Card(&#x27;staff&#x27;, 400, 300)
        &gt;&gt;&gt; staff_member.name
        &#x27;staff&#x27;
        &gt;&gt;&gt; staff_member.attack
        400
        &gt;&gt;&gt; staff_member.defense
        300
        &gt;&gt;&gt; other_staff = Card(&#x27;other&#x27;, 300, 500)
        &gt;&gt;&gt; other_staff.attack
        300
        &gt;&gt;&gt; other_staff.defense
        500
        &quot;&quot;&quot;
        "*** YOUR CODE HERE ***"

    def power(self, other_card):
        &quot;&quot;&quot;
        Calculate power as:
        (player card&#x27;s attack) &#x2d; (opponent card&#x27;s defense)/2
        where other_card is the opponent&#x27;s card.
        &gt;&gt;&gt; staff_member = Card(&#x27;staff&#x27;, 400, 300)
        &gt;&gt;&gt; other_staff = Card(&#x27;other&#x27;, 300, 500)
        &gt;&gt;&gt; staff_member.power(other_staff)
        150.0
        &gt;&gt;&gt; other_staff.power(staff_member)
        150.0
        &gt;&gt;&gt; third_card = Card(&#x27;third&#x27;, 200, 400)
        &gt;&gt;&gt; staff_member.power(third_card)
        200.0
        &gt;&gt;&gt; third_card.power(staff_member)
        50.0
        &quot;&quot;&quot;
        "*** YOUR CODE HERE ***"
</code></pre>

        </solution>

        <p>使用 Ok 来测试你的代码：</p>
        <pre><code class="nohighlight">python3 ok -q Card.__init__ --local
python3 ok -q Card.power --local</code></pre>

        <h3 class="question" id="q5">Q5: 创建 Player</h3>

        <p>现在我们已经有了卡牌，并且可以组成卡组，但仍然需要 Player 来使用这些卡牌。
          现在，我们将完善 <code>Player</code> 类的实现。</p>

        <p>每个 <code>Player</code> 实例有三个实例属性：</p>

        <ul>
          <li><code>name</code>：Player 的名称。在游戏中，你可以输入自己的名字，名称会被转换为字符串并传递给构造方法。</li>
          <li><code>deck</code>：<code>Deck</code> 类的一个实例。你可以使用其 <code>.draw()</code> 方法从中抽取卡牌。</li>
          <li><code>hand</code>：一个包含 <code>Card</code> 实例的列表。每个 Player 应该在游戏开始时从 <code>deck</code> 中抽取 5 张卡牌作为起始手牌。
            在游戏过程中，手牌中的卡牌可以通过索引进行选择。当 Player 抽取新卡牌时，该卡牌会被添加到列表末尾。</li>
        </ul>

        <p>完成 <code>Player</code> 类的构造方法，使 <code>self.hand</code> 被初始化为 5 张从 <code>deck</code> 中抽取的卡牌列表。</p>

        <p>接下来，在 <code>Player</code> 类中实现 <code>draw</code> 和 <code>play</code> 方法：</p>

        <ul>
          <li><code>draw</code> 方法用于从 <code>deck</code> 中抽取一张卡，并将其加入 Player 的手牌。</li>
          <li><code>play</code> 方法用于根据给定的索引从 Player 的手牌中移除并返回一张卡。</li>
        </ul>

        <blockquote>
          <p>在实现 <code>Player.__init__</code> 和 <code>Player.draw</code> 方法时，需要调用 <code>deck.draw()</code>。
            不必关心该方法的内部实现，直接使用抽象提供的功能即可！</p>
        </blockquote>


        <solution>

          <pre><code>class Player:
    def __init__(self, deck, name):
        &quot;&quot;&quot;Initialize a Player object.
        A Player starts the game by drawing 5 cards from their deck. Each turn,
        a Player draws another card from the deck and chooses one to play.
        &gt;&gt;&gt; test_card = Card(&#x27;test&#x27;, 100, 100)
        &gt;&gt;&gt; test_deck = Deck([test_card.copy() for _ in range(6)])
        &gt;&gt;&gt; test_player = Player(test_deck, &#x27;tester&#x27;)
        &gt;&gt;&gt; len(test_deck.cards)
        1
        &gt;&gt;&gt; len(test_player.hand)
        5
        &quot;&quot;&quot;
        self.deck = deck
        self.name = name
        "*** YOUR CODE HERE ***"

    def draw(self):
        &quot;&quot;&quot;Draw a card from the player&#x27;s deck and add it to their hand.
        &gt;&gt;&gt; test_card = Card(&#x27;test&#x27;, 100, 100)
        &gt;&gt;&gt; test_deck = Deck([test_card.copy() for _ in range(6)])
        &gt;&gt;&gt; test_player = Player(test_deck, &#x27;tester&#x27;)
        &gt;&gt;&gt; test_player.draw()
        &gt;&gt;&gt; len(test_deck.cards)
        0
        &gt;&gt;&gt; len(test_player.hand)
        6
        &quot;&quot;&quot;
        assert not self.deck.is_empty(), &#x27;Deck is empty!&#x27;
        "*** YOUR CODE HERE ***"

    def play(self, card_index):
        &quot;&quot;&quot;Remove and return a card from the player&#x27;s hand at the given index.
        &gt;&gt;&gt; from cards import *
        &gt;&gt;&gt; test_player = Player(standard_deck, &#x27;tester&#x27;)
        &gt;&gt;&gt; ta1, ta2 = TACard(&quot;ta_1&quot;, 300, 400), TACard(&quot;ta_2&quot;, 500, 600)
        &gt;&gt;&gt; tutor1, tutor2 = TutorCard(&quot;t1&quot;, 200, 500), TutorCard(&quot;t2&quot;, 600, 400)
        &gt;&gt;&gt; test_player.hand = [ta1, ta2, tutor1, tutor2]
        &gt;&gt;&gt; test_player.play(0) is ta1
        True
        &gt;&gt;&gt; test_player.play(2) is tutor2
        True
        &gt;&gt;&gt; len(test_player.hand)
        2
        &quot;&quot;&quot;
        "*** YOUR CODE HERE ***"
</code></pre>

        </solution>

        <p>使用 Ok 来测试你的代码：</p>
        <pre><code class="nohighlight">python3 ok -q Player.__init__ --local
python3 ok -q Player.draw --local
python3 ok -q Player.play --local</code></pre>

        <p>完成这个问题后，你将获得一个可运行的游戏版本！输入：</p>

        <pre><code>python3 cardgame.py</code></pre>

        <p>即可开始玩 Magic: The Lambda-ing！</p>

        <p>当前版本还没有为不同类型的卡牌实现特殊效果。如果你想让这些效果生效，可以尝试完成下面的可选问题。</p>


        <h1 id="optional-questions">选做题</h1>


        <p>以下的代码编写问题都将在 <code>classes.py</code> 中完成。</p>

        <p>对于接下来的部分，<strong>不要</strong>修改代码中已经提供的任何内容。此外，在实现每个方法后，请确保取消注释所有对 <code>print</code>
          的调用。这些调用用于向用户显示信息，修改它们可能会导致你未能通过测试。</p>

        <h3 class="question" id="q6">Q6: Tutors: Flummox</h3>

        <p>为了使这个卡牌游戏更加有趣，我们的卡牌应该具有一些效果！我们将通过 <code>effect</code> 函数来实现这些效果，它接受对手的卡牌、当前玩家和对手玩家作为输入。</p>

        <p>实现 Tutors 的 <code>effect</code> 方法，使其导致对手丢弃手中的前三张卡牌，并且从对方的牌库中抽取三张新卡。假设对手的手牌中至少有三张卡，并且对方的牌库中至少有三张卡。</p>

        <p>记得完成后取消注释中对 <code>print</code> 的调用！</p>

        <solution>

          <pre><code>class TutorCard(Card):
    cardtype = &#x27;Tutor&#x27;

    def effect(self, other_card, player, opponent):
        &quot;&quot;&quot;
        Discard the first 3 cards in the opponent&#x27;s hand and have
        them draw the same number of cards from their deck.
        &gt;&gt;&gt; from cards import *
        &gt;&gt;&gt; player1, player2 = Player(player_deck, &#x27;p1&#x27;), Player(opponent_deck, &#x27;p2&#x27;)
        &gt;&gt;&gt; other_card = Card(&#x27;other&#x27;, 500, 500)
        &gt;&gt;&gt; tutor_test = TutorCard(&#x27;Tutor&#x27;, 500, 500)
        &gt;&gt;&gt; initial_deck_length = len(player2.deck.cards)
        &gt;&gt;&gt; tutor_test.effect(other_card, player1, player2)
        p2 discarded and re&#x2d;drew 3 cards!
        &gt;&gt;&gt; len(player2.hand)
        5
        &gt;&gt;&gt; len(player2.deck.cards) == initial_deck_length &#x2d; 3
        True
        &quot;&quot;&quot;
        "*** YOUR CODE HERE ***"
        #Uncomment the line below when you&#x27;ve finished implementing this method!
        #print(&#x27;{} discarded and re&#x2d;drew 3 cards!&#x27;.format(opponent.name))</code></pre>

        </solution>

        <p>使用 Ok 来测试你的代码：</p>
        <pre><code class="nohighlight">python3 ok -q TutorCard.effect --local</code></pre>

        <h3 class="question" id="q7">Q7: TAs: Shift</h3>

        <p>现在我们为 TAs 添加一个效果！实现 TAs 的 <code>effect</code> 方法，它会交换对手卡牌的攻击力和防御力。</p>

        <solution>

          <pre><code>class TACard(Card):
    cardtype = &#x27;TA&#x27;

    def effect(self, other_card, player, opponent):
        &quot;&quot;&quot;
        Swap the attack and defense of an opponent&#x27;s card.
        &gt;&gt;&gt; from cards import *
        &gt;&gt;&gt; player1, player2 = Player(player_deck, &#x27;p1&#x27;), Player(opponent_deck, &#x27;p2&#x27;)
        &gt;&gt;&gt; other_card = Card(&#x27;other&#x27;, 300, 600)
        &gt;&gt;&gt; ta_test = TACard(&#x27;TA&#x27;, 500, 500)
        &gt;&gt;&gt; ta_test.effect(other_card, player1, player2)
        &gt;&gt;&gt; other_card.attack
        600
        &gt;&gt;&gt; other_card.defense
        300
        &quot;&quot;&quot;
        "*** YOUR CODE HERE ***"
</code></pre>

        </solution>

        <p>使用 Ok 来测试你的代码：</p>
        <pre><code class="nohighlight">python3 ok -q TACard.effect --local</code></pre>


        html
        复制代码
        <h3 class="question" id="q8">Q8: The Professor Arrives</h3>

        <p>一个新的挑战者出现了！实现 Professor 的 <code>effect</code> 方法，它会将对手卡牌的攻击力和防御力加到玩家卡组中的所有卡牌上，然后移除对手卡组中所有与对手卡牌的攻击力或防御力相同的卡牌。
        </p>

        <blockquote>
          <p><em>注意：</em>当你在遍历列表时修改该列表，可能会遇到问题。试着遍历列表的副本！你可以通过切片来复制列表：</p>

          <pre><code>  &gt;&gt;&gt; lst = [1, 2, 3, 4]
  &gt;&gt;&gt; copy = lst[:]
  &gt;&gt;&gt; copy
  [1, 2, 3, 4]
  &gt;&gt;&gt; copy is lst
  False</code></pre>
        </blockquote>

        <solution>

          <pre><code>class ProfessorCard(Card):
    cardtype = &#x27;Professor&#x27;

    def effect(self, other_card, player, opponent):
        &quot;&quot;&quot;
        Adds the attack and defense of the opponent&#x27;s card to
        all cards in the player&#x27;s deck, then removes all cards
        in the opponent&#x27;s deck that share an attack or defense
        stat with the opponent&#x27;s card.
        &gt;&gt;&gt; test_card = Card(&#x27;card&#x27;, 300, 300)
        &gt;&gt;&gt; professor_test = ProfessorCard(&#x27;Professor&#x27;, 500, 500)
        &gt;&gt;&gt; opponent_card = test_card.copy()
        &gt;&gt;&gt; test_deck = Deck([test_card.copy() for _ in range(8)])
        &gt;&gt;&gt; player1, player2 = Player(test_deck.copy(), &#x27;p1&#x27;), Player(test_deck.copy(), &#x27;p2&#x27;)
        &gt;&gt;&gt; professor_test.effect(opponent_card, player1, player2)
        3 cards were discarded from p2&#x27;s deck!
        &gt;&gt;&gt; [(card.attack, card.defense) for card in player1.deck.cards]
        [(600, 600), (600, 600), (600, 600)]
        &gt;&gt;&gt; len(player2.deck.cards)
        0
        &quot;&quot;&quot;
        orig_opponent_deck_length = len(opponent.deck.cards)
        "*** YOUR CODE HERE ***"
        discarded = orig_opponent_deck_length &#x2d; len(opponent.deck.cards)
        if discarded:
            #Uncomment the line below when you&#x27;ve finished implementing this method!
            #print(&#x27;{} cards were discarded from {}\&#x27;s deck!&#x27;.format(discarded, opponent.name))
            return</code></pre>

        </solution>

        <p>使用 Ok 来测试你的代码：</p>
        <pre><code class="nohighlight">python3 ok -q ProfessorCard.effect --local</code></pre>

        <p>完成这个问题后，我们将拥有一个功能完整的 Magic: The Lambda-ing 游戏！不过，这不必是结束 - 我们鼓励你发挥创意，添加更多卡牌类型、效果，甚至将更多自定义卡牌加入你的卡组！</p>

        <script>
          $('.alwaystoggle').css('display', 'inline-block');
          $('.alwaystoggle').click(function () {
            var solution_id = $(this).attr('id');
            $('div.' + solution_id).slideToggle(600);
          });
        </script>

      </div>

      <div class='col-md-3 sticky'>
        <nav class='hidden-print hidden-sm hidden-xs sidebar'>
          <ul>
            <li><a href="#topics">主要内容</a></li>
            <ul>
              <li><a href="#iterators">Iterators</a></li>
              <ul>
                <li><a href="#iterable-uses">Iterable Uses</a></li>
              </ul>
              <li><a href="#generators">Generators</a></li>
              <li><a href="#object-oriented-programming">Object-Oriented Programming</a></li>
            </ul>
            <li><a href="#required-questions">必答题</a></li>
            <ul>
              <li><a href="#iterators-and-generators">迭代器与生成器</a></li>
              <ul>
                <li><a href="#q1">Q1: 缩放序列</a></li>
                <li><a href="#q2">Q2: 冰雹序列</a></li>
              </ul>
              <li><a href="#wwpd-objects">WWPD: 对象</a></li>
              <ul>
                <li><a href="#q3">Q3: 汽车类 (Car Class)</a></li>
              </ul>
              <li><a href="#magic-the-lambda-ing">Magic: The Lambda-ing</a></li>
              <ul>
                <li><a href="#q4">Q4: 创建卡牌</a></li>
                <li><a href="#q5">Q5: 创建 Player</a></li>
              </ul>
            </ul>
            <li><a href="#optional-questions">选做题</a></li>
            <ul>
              <li><a href="#q6">Q6: Tutors: Flummox</a></li>
              <li><a href="#q7">Q7: TAs: Shift</a></li>
              <li><a href="#q8">Q8: The Professor Arrives</a></li>
            </ul>
          </ul>
        </nav>
      </div>
    </div>

  </main>

  <footer class="container">
    <div class="row text-center">
      <div class="col col-sm-4">
        <h3><a href="../../">CS 61A</a></h3>
        <ul class="nav nav-pills nav-stacked">
          <li><a href="../../weekly.html">Weekly Schedule</a></li>
          <li><a href="../../office-hours.html">Office Hours</a></li>
          <li><a href="../../staff.html">Staff</a></li>
        </ul>
      </div>
      <div class="col col-sm-4">
        <h3><a href="../../resources.html">Resources</a></h3>
        <ul class="nav nav-pills nav-stacked">
          <li><a href="../../articles/studying.html">Studying Guide</a></li>
          <li><a href="../../articles/debugging.html">Debugging Guide</a></li>
          <li><a href="../../articles/composition.html">Composition Guide</a></li>
        </ul>
      </div>
      <div class="col col-sm-4">
        <h3><a href="../../articles/about.html">Policies</a></h3>
        <ul class="nav nav-pills nav-stacked">
          <li><a href="../../articles/about.html#assignments">Assignments</a></li>
          <li><a href="../../articles/about.html#exams">Exams</a></li>
          <li><a href="../../articles/about.html#grading">Grading</a></li>
        </ul>
      </div>
    </div>
  </footer>



  <script src="../../assets/js/sketchy.js"></script>
  <script>
    $('.sidebar ul').addClass('nav nav-stacked noselect');
    $('body').scrollspy({
      target: '.sidebar',
      offset: 40
    });

    function goToId(id) {
      var target = $(id);
      target.parent().show();
      $('html,body').animate({
        scrollTop: target.offset().top,
      }, 100);
      $("body").scrollspy('refresh');
    }

    if (location.hash) {
      setTimeout(function () {
        if (location.hash) {
          goToId(location.hash);
        }
      }, 1);
    }

    $("a").click(function (event) {
      var urlBeforeHashRegEx = new RegExp("^" + window.location.href.split("#")[0]);
      if (/^#/.test(this.hash) && urlBeforeHashRegEx.test(this.href)) {
        event.preventDefault();
        goToId(this.hash);
        document.location.hash = this.hash;
      }
    });
  </script>

</body>

</html>